МІНІСТЕРСТВО ОСВІТИ І НАУКИ УКРАЇНИ
 
ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ
УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ
 
Кафедра «Програмна інженерія»
 
 


ЗВІТ
до лабораторної роботи 2
з дисципліни «Аналіз та рефакторинг коду»
на тему: «Розробка бази даних для серверної частини системи та прикладного програмного інтерфейсу (API)»

 




Виконав:                                                           	         Перевірив:
ст. гр. ПЗПІ-23-3                                     	       	          ст. викладач катедри ПІ
Першина М. А.                                     	       	         Сокорчук Ігор Петрович






Харків 2025


1 ІСТОРІЯ ЗМІН
№	Дата	Версія звіту	Опис змін та виправлень
1	20.11.2025	0.1	Початок роботи серверною частиною програми
2	24.11.2025	0.2	Доопрацювання звіту та відеозапису



2 ЗАВДАННЯ
Ознайомитися з процесом розробки серверної частини програмної системи, включаючи проектування бази даних (БД), розробку API для взаємодії з клієнтами, та перевірку (тестування) їхньої взаємодії. Оволодіти методами проектування діаграм UML та ER, розробки БД, програмної реалізації API, а також роботи з репозиторіями Git та створення технічної документації.

3. ОПИС ВИКОНАНОЇ РОБОТИ
1. Архітектурні рішення для серверної частини системи
1.1 Архітектурні рішення для серверної частини
Серверна частина реалізована на Node.js з Express.js фреймворком та використовує багатошарову MVC архітектуру. Структура проєкту організована в модульні папки: контролери для обробки HTTP запитів (автентифікація, рослини, датчики, користувачі), сервіси з бізнес-логікою (управління рослинами, автоматизація догляду, система сповіщень), моделі для роботи з базою даних через Sequelize ORM, маршрути для API endpoints, middleware для автентифікації, валідації та обробки помилок. Сервер налаштований з CORS для cross-origin запитів та додатковими заходами безпеки.
1.2 Архітектурні рішення для клієнтських взаємодій
REST API забезпечує повний функціонал для мобільного та веб-клієнтів через стандартизовані HTTP методи. Реалізовані endpoints для автентифікації користувачів, CRUD операції з рослинами, отримання та збереження даних з датчиків, управління профілем користувача. MQTT протокол використовується для двосторонньої комунікації з Arduino пристроями через топіки для отримання телеметрії та відправки команд управління. WebSocket з'єднання забезпечує real-time сповіщення користувачам про критичні події в системі догляду за рослинами.
1.3 Архітектурні рішення для БД
PostgreSQL база даних організована з оптимізованою структурою для швидкого доступу до даних. Sequelize ORM налаштований з пулом з'єднань для ефективного використання ресурсів. Система міграцій забезпечує версіонування схеми бази даних, а seeders використовуються для завантаження початкових даних типів рослин та адміністративних налаштувань. Налаштовані індекси на часто запитувані поля для оптимізації продуктивності та foreign key обмеження для підтримки цілісності даних.
1.4 Моделі системи та їх зв'язки
Модель Користувача містить базову інформацію профілю, дані автентифікації та часові мітки створення. Модель Рослини включає ідентифікацію власника, тип рослини, назву та розташування з прив'язкою до користувача та типу рослини. Модель Типу Рослини зберігає оптимальні параметри догляду такі як вологість, температура, освітленість та частота поливу. Модель Датчика описує фізичні сенсори з їх типом, апаратним ідентифікатором та статусом активності, прив'язані до конкретної рослини. Модель Даних Датчика фіксує всі вимірювання з часовими мітками, створюючи історію моніторингу. Зв'язки між моделями: користувач може мати множину рослин, кожна рослина належить до певного типу та має множину датчиків, кожен датчик генерує множину записів даних.

2. UML діаграма прецедентів для серверної частини системи
UML діаграма прецедентів показує, що користувач може автентифікуватися та авторизуватися в системі (реєстрація, вхід), управляти рослинами (додавання, редагування, видалення), моніторити показники рослин (перегляд поточних даних та історії вимірювань), налаштовувати автоматизацію догляду (автоматичний полив, освітлення, планування), отримувати сповіщення про стан рослин (критичні алерти, оновлення статусу) та переглядати аналітику і звіти (щоденні звіти, аналіз трендів росту). IoT пристрій може надсилати дані з датчиків (що включає валідацію та збереження даних у БД) та виконувати команди догляду, які генеруються системою автоматизації. Діаграма демонструє, що всі процеси автоматичного догляду (полив, освітлення, планування) обов'язково включають обробку логіки автоматизації, яка визначає необхідні дії на основі отриманих даних з датчиків та налаштувань користувача.
 
Рисунок 1 - UML діаграма прецедентів

3. ER-діаграма даних
Сутність "Користувач" містить облікові дані (ідентифікатор, електронну пошту, прізвище, ім'я користувача, пароль) та пов'язана відношенням "один до багатьох" з сутністю "Рослина", що означає - один користувач може володіти множиною рослин. Сутність "Тип рослини" зберігає еталонні параметри догляду (оптимальну вологість, температуру, освітлення, частоту поливу) та також має відношення "один до багатьох" з "Рослиною" - один тип може відповідати багатьом конкретним рослинам користувачів. Сутність "Рослина" є центральною та містить персональну інформацію (назву, розташування) з зовнішніми ключами до користувача-власника та типу рослини. "Датчик" пов'язаний з конкретною рослиною відношенням "один до багатьох" та зберігає технічні характеристики (тип датчика, апаратний ідентифікатор, статус активності), а сутність "Дані датчика" фіксує всі вимірювання з часовими мітками, створюючи відношення "один до багатьох" з датчиком для збереження історії моніторингу параметрів навколишнього середовища.
 
Рисунок 2 - ER діаграма
4. Схема нормалізації даних (1NF, 2NF, 3NF)
1NF (Перша нормальна форма)
Це початковий стан - всі дані зберігаються в одній великій таблиці T1. Кольорові стрілки показують логічне групування полів: сині - для типу рослини, зелені - для користувача, помаранчеві - для датчика, червоні - для даних вимірювань. Це демонструє, що всі дані змішані в одній таблиці з великою кількістю повторень.
 
Рисунок 3 - Функціональні залежності універсального відношення 
2NF (Друга нормальна форма)
З основної таблиці T1 винесено три окремі сутності: T2 (користувач - бірюзова), T3 (тип рослини - жовта), T4 (датчик з даними - фіолетова). Основна таблиця T1 тепер містить тільки базову інформацію про рослини та зовнішні ключі для зв'язку з винесеними таблицями.
 
Рисунок 4 - Результат перетворення таблиці «Т1»
3NF (Третя нормальна форма)
Додатково винесено ще одну сутність - T5 (дані вимірювань датчиків - бірюзова внизу). Тепер маємо п'ять окремих таблиць: T1 (рослини), T2 (користувачі), T3 (датчики), T4 (типи рослин), T5 (дані вимірювань). Кожна таблиця відповідає за одну конкретну сутність.

 
Рисунок 5 - Результат перетворення таблиці «Т3»

5. Діаграма структури БД
Створена діаграма структури бази даних демонструє фінальну архітектуру системи автоматичного догляду за рослинами після повної нормалізації до третьої нормальної форми. Діаграма включає п'ять основних таблиць з чітко визначеними зв'язками типу "один до багатьох": користувач може мати множину рослин, кожна рослина належить до конкретного типу з визначеними параметрами догляду, рослина може мати кілька датчиків різних типів, а кожен датчик генерує множину записів вимірювань у часі. Всі таблиці мають первинні ключі (PK) та зовнішні ключі (FK) для забезпечення цілісності даних, а додаткові обмеження включають унікальність електронної пошти, індекси для оптимізації запитів, правила CASCADE DELETE для автоматичного видалення залежних записів та CHECK-обмеження для валідації числових значень. Така структура забезпечує ефективне зберігання даних без надмірності, підтримує складні запити для аналітики та гарантує консистентність інформації в системі IoT-моніторингу рослин.

 
Рисунок 6 - Діаграма структури БД

6. Функції роботи з БД (ORM)
У проекті було обрано Object-Relational Mapping (ORM) підхід з використанням бібліотеки Sequelize для Node.js. Цей підхід дозволяє працювати з базою даних PostgreSQL через об'єктно-орієнтовані моделі, що забезпечує типобезпеку та зручність розробки. Було створено п'ять основних моделей: User (користувачі), PlantType (типи рослин), Plant (рослини), Sensor (датчики) та SensorData (дані датчиків).
Кожна модель підтримує повний набір CRUD-операцій через методи Sequelize: create() для створення записів, findAll() та findByPk() для читання, update() для оновлення та destroy() для видалення. Моделі містять валідацію даних, визначення зв'язків між таблицями та автоматичне управління часовими мітками. Наприклад, модель User включає перевірку формату електронної пошти та автоматичне хешування паролів.
const user = await User.create({
  email: 'user@example.com',
  first_name: 'Іван',
  last_name: 'Петренко',
  password_hash: hashedPassword
});

7. API для взаємодії серверної частини з клієнтами
Для взаємодії з клієнтами було обрано архітектурний стиль REST (Representational State Transfer), який забезпечує стандартизований та інтуїтивно зрозумілий інтерфейс. REST API використовує HTTP методи для виконання операцій: GET для отримання даних, POST для створення, PUT для оновлення та DELETE для видалення ресурсів. Цей підхід забезпечує простоту інтеграції та широку підтримку різними клієнтськими технологіями.
API структуровано навколо основних ресурсів системи: /api/users для управління користувачами, /api/plant-types для роботи з типами рослин, /api/plants для управління рослинами, /api/sensors для роботи з датчиками та /api/sensor-data для обробки телеметричних даних. Кожен ендпоінт підтримує відповідні HTTP методи та параметри, наприклад, GET /api/users/:id для отримання конкретного користувача або POST /api/plants для створення нової рослини з параметрами у JSON форматі.
Всі відповіді API стандартизовано у форматі JSON з обов'язковими полями success, data, message та error, що забезпечує консистентність обробки відповідей на клієнтській стороні. Додатково реалізовано обробку помилок з відповідними HTTP статус-кодами та детальними повідомленнями для розробників.

8. Специфікація розробленого API:
Специфікація API створена з використанням стандарту OpenAPI 3.0 (Swagger), що забезпечує повну документацію всіх ендпоінтів з детальними описами параметрів, форматів запитів та відповідей. Документація включає схеми даних для всіх моделей, приклади JSON запитів та відповідей, а також опис можливих помилок з відповідними HTTP кодами статусу.
Кожен ендпоінт задокументовано з зазначенням призначення, обов'язкових та опціональних параметрів, формату тіла запиту та структури відповіді. Специфікація містить приклади реального використання API, включаючи створення користувача, додавання рослини, реєстрацію датчика та збереження телеметричних даних. Документація автоматично генерується з анотацій у коді та доступна через інтерактивний веб-інтерфейс Swagger UI за адресою /api/docs.
{
  "success": true,
  "data": {
    "user_id": 1,
    "email": "user@example.com",
    "first_name": "Іван",
    "last_name": "Петренко"
  },
  "message": "User retrieved successfully"
}
9. Програмна реалізація API та функцій роботи з БД
Серверна частина реалізована на Node.js з використанням фреймворку Express.js та мови TypeScript для забезпечення типобезпеки коду. Архітектура побудована за принципом розділення відповідальності: контролери обробляють HTTP запити та формують відповіді, моделі інкапсулюють логіку роботи з базою даних, а маршрути визначають URL-адреси ендпоінтів. Всі компоненти покрито типізацією TypeScript для запобігання помилкам на етапі компіляції.
Система інтегрована з базою даних PostgreSQL через Sequelize ORM, що забезпечує автоматичну синхронізацію схеми бази даних з моделями додатку. Реалізовано middleware для обробки CORS, безпеки (Helmet), парсингу JSON та глобальної обробки помилок. Додатково налаштовано Docker-контейнеризацію для забезпечення консистентного середовища розробки та розгортання.
Код організовано у модульну структуру з чіткою ієрархією папок: models/ для Sequelize моделей, controllers/ для обробки бізнес-логіки, routes/ для визначення API ендпоінтів, config/ для налаштувань бази даних та types/ для TypeScript інтерфейсів. Це забезпечує легкість підтримки та розширення функціональності системи.

4. ВИСНОВКИ
У ході виконання лабораторної роботи №2 успішно розроблено повноцінну серверну частину системи догляду за рослинами з використанням сучасних технологій веб-розробки. Реалізовано Object-Relational Mapping через Sequelize ORM, що забезпечує ефективну взаємодію з базою даних PostgreSQL та підтримку всіх CRUD-операцій для основних сутностей системи. Набуто практичні навички проектування реляційних баз даних, створення моделей з валідацією та встановлення зв'язків між таблицями.
Розроблено REST API архітектуру з повним набором ендпоінтів для взаємодії клієнтських додатків із серверною логікою, що включає управління користувачами, рослинами, датчиками та обробку телеметричних даних. Створено детальну API специфікацію згідно стандарту OpenAPI 3.0 з інтерактивною документацією Swagger UI, що значно спрощує процес тестування та інтеграції з клієнтськими додатками. Застосовано TypeScript для забезпечення типобезпеки коду та покращення процесу розробки.
Програмну реалізацію протестовано на всіх рівнях: від підключення до бази даних до функціонального тестування API ендпоінтів, що підтверджує готовність системи для інтеграції з IoT пристроями та клієнтськими додатками у наступних етапах розробки. Застосування Docker-контейнеризації забезпечує стабільне середовище розробки та спрощує процес розгортання системи.
5. ВИКОРИСТАНІ ДЖЕРЕЛА
1.	Node.js Official Documentation [Електронний ресурс]. – Режим доступу: https://nodejs.org/en/docs/ – Дата доступу: 13.12.2025. 
2.	Express.js Framework Documentation [Електронний ресурс]. – Режим доступу: https://expressjs.com/ – Дата доступу: 13.12.2025. 
3.	Sequelize ORM Documentation [Електронний ресурс]. – Режим доступу: https://sequelize.org/docs/ – Дата доступу: 13.12.2025. 
4.	PostgreSQL Official Documentation [Електронний ресурс]. – Режим доступу: https://www.postgresql.org/docs/ – Дата доступу: 13.12.2025. 
5.	OpenAPI Specification 3.0 [Електронний ресурс]. – Режим доступу: https://swagger.io/specification/ – Дата доступу: 13.12.2025. 
6.	TypeScript Documentation [Електронний ресурс]. – Режим доступу: https://www.typescriptlang.org/docs/ – Дата доступу: 13.12.2025. 
7.	Docker Documentation [Електронний ресурс]. – Режим доступу: https://docs.docker.com/ – Дата доступу: 13.12.2025. 


ДОДАТОК А
Відеозапис

Відеозапис доповіді: https://youtu.be/ATUDUOdH1l0

Хронологічний опис відеозапису: 
00:00 - Вступ 
00:20 - Діаграма прецедентів 
00:41 - ER-діаграма 
01:00 - Нормалізація БД 
01:28 - Swagger документація 
02:27 - Демонстрація роботи основних ендпоінтів

